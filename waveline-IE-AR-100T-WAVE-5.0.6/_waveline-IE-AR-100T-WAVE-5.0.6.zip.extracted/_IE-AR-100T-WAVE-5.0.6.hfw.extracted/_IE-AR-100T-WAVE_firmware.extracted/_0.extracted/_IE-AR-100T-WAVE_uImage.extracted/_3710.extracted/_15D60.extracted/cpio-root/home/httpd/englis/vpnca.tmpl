

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="author" content="Enrico Kalliwoda">
<meta name="description" content="Waveline router / Weidmueller Heyfra GmbH u. Co. KG">
<meta name="date" content="2009-05-18 11:00:00">
<meta http-equiv="pragma" content="no-cache">
<meta http-equiv="cache-control" content="no-store">
<meta http-equiv="expires" content="0">
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">
<title>Zertifikate</title>
<link rel="stylesheet" type="text/css" href="css/stile.css" media="screen">
<script src="englis/auxfunc.js" type="text/javascript"></script>
<script type="text/javascript">
<!--

function checkValues() {
  var result=true;
  if (document.vpncaForm.common.value == "") {
    alert("Please insert a common name!");
    document.vpncaForm.common.focus();
    result = false;
  }
  if (result && document.vpncaForm.org_unit.value == "") {
    alert("Please insert an organisational unit!");
    document.vpncaForm.org_unit.focus();
    result = false;
  }
  if (result && document.vpncaForm.orga.value == "") {
    alert("Please insert an organisation!");
    document.vpncaForm.orga.focus();
    result = false;
  }
  if (result && document.vpncaForm.locatio.value == "") {
    alert("Please insert a location!");
    document.vpncaForm.locatio.focus();
    result = false;
  }
  if (result && document.vpncaForm.region.value == "") {
    alert("Please insert a state or province!");
    document.vpncaForm.region.focus();
    result = false;
  }
  if (result && document.vpncaForm.country.selectedIndex <0) {
    alert("Please choose a country!");
    document.vpncaForm.country.focus();
    result = false;
  }
  if (result && document.vpncaForm.email.value == "") {
    alert("Please insert an email address!");
    document.vpncaForm.email.focus();
    result = false;
  }
  if(result && (document.vpncaForm.so_pass.value.length == 0)) {
    result = false;
    alert("Please insert a security officer password!");
    document.vpncaForm.so_pass.focus();
  }
  if(document.vpncaForm.cert_type[2].checked &&
     document.vpncaForm.so_pass.value != document.vpncaForm.re_so.value) {
    result = false;
    alert("The security officer password doesn't match it's repetition!");
    document.vpncaForm.so_pass.value = document.vpncaForm.re_so.value = "";
    document.vpncaForm.so_pass.focus();
  }
  if(result && (document.vpncaForm.cert_type[0].checked || document.vpncaForm.cert_type[1].checked) &&
     (document.vpncaForm.su_pass.value.length == 0)) {
    result = false;
    alert("Please insert a certificate password!");
    document.vpncaForm.su_pass.focus();
  }
  if(result && (document.vpncaForm.cert_type[0].checked || document.vpncaForm.cert_type[1].checked) &&
     document.vpncaForm.su_pass.value != document.vpncaForm.re_su.value) {
    result = false;
    alert("The certificate password doesn't match it's repetition!");
    document.vpncaForm.su_pass.value = document.vpncaForm.re_su.value = "";
    document.vpncaForm.su_pass.focus();
  }
  if (result && document.vpncaForm.cert_type[0].checked) {
    document.vpncaForm.act.value = "0";
    document.vpncaForm.step.value = "2";
  }
  if (result && document.vpncaForm.cert_type[2].checked) {
    result = confirm("Dieser Vorgang macht alle frueher vergebenen Zertifikate ungueltig. Wollen Sie fortsetzen?");
  }

  if(result==true) document.vpncaForm.submit();
}

function checkState(i) {
  switch(i) {
  case 0:
      document.vpncaForm.so_pass.disabled=false;
      document.vpncaForm.re_so.disabled=true;
      document.vpncaForm.su_pass.disabled=false;
      document.vpncaForm.re_su.disabled=false;
      document.getElementById("so_cell").style.visibility = "hidden";
      document.getElementById("su_row").style.visibility = "visible";
    break;
  case 1:
      document.vpncaForm.so_pass.disabled=false;
      document.vpncaForm.re_so.disabled=true;
      document.vpncaForm.su_pass.disabled=false;
      document.vpncaForm.re_su.disabled=false;
      document.getElementById("so_cell").style.visibility = "hidden";
      document.getElementById("su_row").style.visibility = "visible";
    break;
  case 2:
      document.vpncaForm.so_pass.disabled=false;
      document.vpncaForm.re_so.disabled=false;
      document.vpncaForm.su_pass.disabled=true;
      document.vpncaForm.re_su.disabled=true;
      document.getElementById("so_cell").style.visibility = "visible";
      document.getElementById("su_row").style.visibility = "collapse";
    break;
  }
}

//-->
</script>
</head>
<body onLoad="checkState(1);">
<form action="config.cgi" method="post" target="Main" name="vpncaForm">
  <input type="hidden" name="lang" value="englis">
  <input type="hidden" name="item" value="26">
  <input type="hidden" name="act" value="1">
  <input type="hidden" name="step" value="0">
<fieldset><legend>Create certificates</legend>
<table>
  <tr>
    <td colspan="3">
      The router's system date: {SYSTEMDATUM}
    </td>
  </tr>
  <tr>
    <td colspan="3">
    <input type="radio" name="cert_type" value="peer" onClick="checkState(0);" checked>Peer certificate
    <input type="radio" name="cert_type" value="gate" onClick="checkState(1);">Gateway certificate
    <input type="radio" name="cert_type" value="auth" onClick="checkState(2);">new Certification Authority
    </td>
  </tr>
  <tr>
    <td>Common Name</td>
    <td><input type="text" size="35" maxlength="64" name="common" value=""></td>
    <td>unique certificate descriptor</td>
  </tr>
  <tr>
    <td>Organisational unit</td>
    <td><input type="text" size="35" name="org_unit" value="{ORGUNIT}"></td>
    <td>certificate owner's unit or position</td>
  </tr>
  <tr>
    <td>Organisation</td>
    <td><input type="text" size="35" name="orga" value="{ORG}"></td>
    <td>Institution or membership</td>
  </tr>
  <tr>
    <td>Location</td>
    <td><input type="text" size="35" name="locatio" value="{LOCATION}"></td>
    <td></td>
  </tr>
  <tr>
    <td>State</td>
    <td><input type="text" size="35" name="region" value="{REGION}"></td>
    <td>State or province</td>
  </tr>
  <tr>
    <td>Country</td>
    <td><select  name="country">{COUNTRYOPTS}
    </select></td>
    <td>Country code</td>
  </tr>
  <tr>
    <td>Email</td>
    <td><input type="text" size="35" maxlength="40" name="email" value="{EMAIL}"></td>
    <td>Certificate owner's email address</td>
  </tr>
  <tr>
    <td>Security officer password</td>
    <td><input type="password" size="35" maxlength="40" name="so_pass" value=""></td>
    <td id="so_cell">repeated<input type="password" size="35" maxlength="40" name="re_so" value=""></td>
  </tr>
  <tr id="su_row">
    <td>Certificate password</td>
    <td><input type="password" size="35" maxlength="40" name="su_pass" value=""></td>
    <td>repeated<input type="password" size="35" maxlength="40" name="re_su" value=""></td>
  </tr>
</table>
</fieldset>
<table align="right">
    <tr>
      <td><input type="reset" name="Cancel_Button" value="Cancel"></td>
      <td><input type="button" name="OK_Button" value="Generate" onclick="checkValues()"></td>
    </tr>
</table>
</form>
</body>
</html>
